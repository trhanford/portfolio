/* ==================================================================
   Portfolio Page Styles
   ================================================================== */
body.portfolio-page{
  background:var(--paper);
  color:var(--slate);
}

body.portfolio-page main{
  padding-top:calc(var(--nav-h) + 32px);
}

.visually-hidden{
  position:absolute;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0, 0, 0, 0);
  white-space:nowrap;
  border:0;
}

.portfolio-hero{
  position:relative;
  padding:110px 0 68px;
  background:linear-gradient(180deg, rgba(228,221,204,.9) 0%, rgba(228,221,204,.42) 58%, rgba(228,221,204,0) 100%);
  border-bottom:1px solid rgba(15,17,19,.08);
  overflow:hidden;
}

.portfolio-hero::after{
  content:"";
  position:absolute;
  left:0;
  right:0;
  bottom:-32vh;
  height:44vh;
  background:linear-gradient(180deg, rgba(228,221,204,.32) 0%, rgba(255,255,255,.96) 60%, #ffffff 100%);
  z-index:-2;
}

.portfolio-hero-bg{
  position:absolute;
  inset:-12vh 0 0 0;
  z-index:-3;
  background:linear-gradient(180deg, rgba(228,221,204,1) 0%, rgba(228,221,204,.92) 34%, rgba(228,221,204,.4) 72%, rgba(228,221,204,0) 100%);
  pointer-events:none;
}

.portfolio-hero .hero-inner{
  position:relative;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
  gap:32px;
}

@media (max-width:980px){
  .portfolio-hero{padding:96px 0 56px;}
  .portfolio-hero .hero-inner{gap:28px;}
}

.hero-copy .hero-title{
  font-size:clamp(2.5rem, 5vw, 3.8rem);
  font-family:'Playfair Display', Georgia, serif;
  color:var(--slate-strong);
}

.hero-copy .hero-subtitle{
  margin-top:14px;
  font-size:clamp(1.02rem, 2vw, 1.28rem);
  color:var(--muted);
  max-width:36ch;
}

.hero-actions{
  margin-top:32px;
  display:flex;
  align-items:center;
  gap:16px;
}

.start-exploring-btn{
  position:relative;
  display:inline-flex;
  align-items:center;
  gap:12px;
  padding:18px 32px;
  border-radius:999px;
  font-weight:800;
  letter-spacing:.08em;
  text-transform:uppercase;
  background:rgba(228,221,204,.92);
  border:1px solid rgba(43,47,51,.18);
  box-shadow:var(--shadow-1);
  color:var(--slate-strong);
  transition:transform .2s ease, box-shadow .2s ease, background-color .2s ease, color .2s ease;
}

.hero-actions .start-exploring-btn{
  align-self:flex-start;
  margin-left:-6px;
}

.start-exploring-btn::before,
.start-exploring-btn::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  border:2px solid rgba(43,47,51,.18);
  opacity:0;
  transform:scale(.9);
}

.start-exploring-btn:hover::before{animation:burst 900ms ease-out forwards;}
.start-exploring-btn:hover::after{animation:burst 1200ms 90ms ease-out forwards;}

.start-exploring-btn:hover{
  transform:translateY(-1px);
  box-shadow:var(--shadow-2);
  background:#c4c8ce;
  color:#ffffff;
}

.start-exploring-btn:focus-visible{
  outline:3px solid var(--focus);
  outline-offset:4px;
}

.start-exploring-btn .arrow{
  font-size:1.2rem;
  transition:transform .2s ease;
}

.start-exploring-btn:hover .arrow{transform:translateX(4px);}

@media (max-width:600px){
  .start-exploring-btn{width:100%;justify-content:center;}
  .hero-actions{margin-top:24px;}
  .hero-actions .start-exploring-btn{margin-left:0;}
}

.portfolio-section{
  padding:60px 0 40px;
  border-bottom:1px solid rgba(15,17,19,.06);
}

.portfolio-section:last-of-type{border-bottom:none;padding-bottom:80px;}

.section-head{
  max-width:720px;
  margin-bottom:32px;
}

.section-head h2{
  font-size:clamp(1.8rem, 4vw, 2.8rem);
  font-family:'Playfair Display', Georgia, serif;
  color:var(--slate-strong);
}

.section-head p{
  margin:0;
  color:var(--muted);
  font-size:1rem;
}

/* ===== Reworked: Project Slider ===== */

.project-slider{
  display:grid;
  gap:22px;
}

.project-slider .slider-menu,
.project-slider .slider-window,
.project-slider .slider-controls{
  width:100%;
}

.project-slider .slider-menu{order:1;}
.project-slider .slider-window{order:2;}
.project-slider .slider-controls{order:3;}

@media (min-width:900px){
  .project-slider{
    grid-template-columns:minmax(210px, 260px) 1fr;
    grid-template-areas:
      "menu window"
      "menu controls";
    align-items:start;
    gap:32px;
  }

  .project-slider .slider-menu{grid-area:menu;}
  .project-slider .slider-window{grid-area:window;}
  .project-slider .slider-controls{grid-area:controls;}
}

.slider-menu{
   position:relative;
  display:flex;
  width:100%;
  justify-content:flex-start;
}

.slider-menu-viewport{
  display:flex;
  gap:12px;
  padding:6px;
  background:rgba(21,24,28,.05);
  border-radius:999px;
  width:100%;
  overflow-x:auto;
  overflow-y:hidden;
  scrollbar-width:none;
  -ms-overflow-style:none;
  transition:background .3s ease, box-shadow .3s ease;
}

.slider-menu-viewport::-webkit-scrollbar{display:none;}

@media (min-width:900px){
  .slider-menu{
     justify-content:center;
  }

  .slider-menu-viewport{
    position:relative;
    flex-direction:column;
    align-items:stretch;
    gap:14px;
    padding:118px 26px;
    background:radial-gradient(circle at 50% 30%, rgba(255,255,255,.96) 0%, rgba(245,241,234,.94) 52%, rgba(226,220,211,.92) 100%);
    border-radius:999px;
    border:1px solid rgba(33,37,43,.08);
    box-shadow:0 25px 45px rgba(16,18,21,.16);
    overflow-y:auto;
    overflow-x:hidden;
    max-height:min(540px, 70vh);
    min-height:clamp(320px, 44vh, 480px);
    scroll-padding-block:118px;
    scroll-snap-type:y proximity;
    mask-image:linear-gradient(to bottom, transparent 0%, rgba(0,0,0,.2) 6%, rgba(0,0,0,.85) 24%, rgba(0,0,0,.95) 50%, rgba(0,0,0,.85) 76%, rgba(0,0,0,.2) 94%, transparent 100%);
    -webkit-mask-image:linear-gradient(to bottom, transparent 0%, rgba(0,0,0,.2) 6%, rgba(0,0,0,.85) 24%, rgba(0,0,0,.95) 50%, rgba(0,0,0,.85) 76%, rgba(0,0,0,.2) 94%, transparent 100%);
  }

  .slider-menu-viewport::before,
  .slider-menu-viewport::after{
    content:"";
    position:sticky;
    left:0;
    right:0;
    height:120px;
    pointer-events:none;
    z-index:1;
  }

  .slider-menu-viewport::before{
    top:0;
    background:linear-gradient(to bottom, rgba(255,255,255,.92) 0%, rgba(255,255,255,0) 100%);
  }

  .slider-menu-viewport::after{
    bottom:0;
    background:linear-gradient(to top, rgba(22,24,28,.65) 0%, rgba(22,24,28,0) 100%);
  }
}

.slider-menu-btn{
  background:transparent;
  border:none;
  font-family:'Playfair Display', Georgia, serif;
  font-size:clamp(1.05rem, 1.4vw, 1.45rem);
  letter-spacing:.01em;
  color:var(--muted);
  padding:12px 18px;
  border-radius:18px;
  cursor:pointer;
  transition:color .25s ease, background-color .25s ease, transform .25s ease, box-shadow .25s ease;
  text-align:left;
  white-space:nowrap;
}
.slider-menu-btn:focus-visible{
  outline:2px solid var(--accent-soft);
  outline-offset:2px;
}
.slider-menu-btn.is-active{
  background:var(--slate-strong);
  color:#fff;
  box-shadow:var(--shadow-2);
  transform:translateX(4px);
}

@media (min-width:900px){
  .slider-menu-btn{
    width:100%;
    white-space:normal;
    padding:16px 20px;
    text-align:center;
    scroll-snap-align:center;
    border-radius:24px;
  }

  .slider-menu-btn.is-active{
    transform:scale(1.02);
    box-shadow:0 18px 28px rgba(16,18,21,.18);
  }
}

.project-slider .slider-window{
  position:relative;
  overflow:hidden;
  border-radius:calc(var(--radius-xl) + 14px);
  padding:clamp(14px, 3vw, 28px);
  background:linear-gradient(145deg, rgba(244,240,234,.9), rgba(255,255,255,.96));
  box-shadow:var(--shadow-1);
  transition:box-shadow .3s ease, background .3s ease, height .4s ease;
  min-height:300px;
  cursor:grab;
  touch-action:pan-y;
}
.project-slider .slider-window:hover{
  box-shadow:var(--shadow-2);
}
@media (max-width:640px){
  .project-slider .slider-window{min-height:260px;padding:16px;}
}

.slider-track{
  display:flex;
  align-items:stretch;
  gap:0;
  width:100%;
  height:100%;
  transform:translateX(0%);
  transition:transform .6s cubic-bezier(.22, 1, .36, 1);
  will-change:transform;
}
.slider-track.is-dragging,
.slider-track.no-transition{
  transition:none;
}
.slider-window.is-dragging{
  cursor:grabbing;
}

.slider-controls{
  display:flex;
  align-items:center;
  gap:16px;
  margin-top:4px;
  flex-wrap:wrap;
}
.slider-arrow{
  width:48px;
  height:48px;
  border-radius:50%;
  border:none;
  background:#fff;
  color:var(--slate-strong);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  box-shadow:var(--shadow-1);
  cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease, background-color .2s ease, color .2s ease;
}
.slider-arrow:hover,
.slider-arrow:focus-visible{
  transform:translateY(-2px);
  box-shadow:var(--shadow-2);
  background:var(--taupe);
  color:#fff;
}

.slider-progress{
  flex:1;
  height:4px;
  border-radius:999px;
  background:rgba(21,24,28,.1);
  position:relative;
  overflow:hidden;
}
.slider-progress-bar{
  position:absolute;
  inset:0;
  width:0%;
  border-radius:inherit;
  background:linear-gradient(90deg, var(--accent-soft), var(--slate-strong));
  transition:width .45s cubic-bezier(.22, 1, .36, 1);
}

/* Project cards (shared) */
.project-card{
  display:grid;
  grid-template-columns:150px 1fr;
  grid-template-rows:auto;
  grid-template-areas:"media info";
  align-items:stretch;
  gap:18px;
  padding:20px;
  background:#fff;
  border-radius:var(--radius-xl);
  border:1px solid rgba(15,17,19,.08);
  box-shadow:var(--shadow-1);
  transition:transform .25s ease, box-shadow .25s ease, opacity .25s ease;
  position:relative;
  height:100%;
}

.project-card:hover{
  transform:translateY(-4px);
  box-shadow:var(--shadow-2);
}

@media (max-width:720px){
  .project-card{
    grid-template-columns:1fr;
    grid-template-areas:
      "media"
      "info";
  }
}

.project-media{
  grid-area:media;
  border-radius:var(--radius-lg);
  overflow:hidden;
  background:var(--taupe);
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

@media (max-width:720px){
  .project-media{min-height:200px;}
}

@media (max-width:520px){
  .project-media{min-height:180px;}
}

.project-media img{
  width:100%;
  height:100%;
  display:block;
  object-fit:cover;
}

.project-media model-viewer{
  width:100%;
  height:100%;
  display:block;
  border:none;
  background:rgba(43,47,51,.04);
  --poster-color:rgba(43,47,51,.82);
  border-radius:inherit;
  min-height:240px;
}

.project-media--viewer{
  padding:0;
}

.project-info{
  grid-area:info;
  display:flex;
  flex-direction:column;
  justify-content:center;
}

.project-info h3{
  margin:0 0 8px;
  font-size:1.25rem;
  font-weight:800;
  color:var(--slate-strong);
}

.project-summary{
  margin:0 0 16px;
  color:var(--muted);
  flex-grow:1;
}

.project-more{
  background:none;
  border:none;
  color:var(--accent-soft);
  font-weight:800;
  font-size:1rem;
  letter-spacing:.02em;
  text-transform:uppercase;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:0;
}

.project-more:hover,.project-more:focus-visible{
  color:var(--slate-strong);
}

/* CAD variant */
.project-slider--cad .project-card{
  grid-template-columns:200px 1fr;
}
@media (max-width:920px){
  .project-slider--cad .project-card{grid-template-columns:1fr;}
}

/* -------------------- Modal -------------------- */
.modal{
  position:fixed;
  inset:0;
  z-index:200;
  display:none;
}

.modal.open{display:block;}

.modal-backdrop{
  position:absolute;
  inset:0;
  background:rgba(20,24,28,.55);
  backdrop-filter:blur(6px);
}

.modal-dialog{
  position:relative;
  margin:80px auto;
  max-width:min(960px, calc(100% - 48px));
  background:#fff;
  border-radius:var(--radius-xl);
  padding:32px 32px 40px;
  box-shadow:0 28px 68px rgba(15,17,19,.35);
  border:1px solid rgba(15,17,19,.18);
}

@media (max-width:720px){
  .modal-dialog{margin:60px auto;padding:24px 20px 32px;}
}

.modal-close{
  position:absolute;
  top:16px;
  right:16px;
  width:38px;
  height:38px;
  border-radius:50%;
  border:none;
  background:rgba(228,221,204,.55);
  font-size:1.6rem;
  font-weight:600;
  cursor:pointer;
}

.modal-close:hover,.modal-close:focus-visible{
  background:rgba(228,221,204,.85);
}

.modal-header{
  margin-bottom:20px;
}

.modal-header h2{
  margin:0;
  font-size:clamp(1.6rem, 3vw, 2.4rem);
  color:var(--slate-strong);
}

.modal-subtitle{
  margin:8px 0 0;
  color:var(--muted);
}

.modal-body{
  display:block;
  gap:24px;
  max-height:min(72vh, 760px);
  overflow-y:auto;
  padding-right:10px;
  scroll-behavior:smooth;
}

.modal-body::-webkit-scrollbar{
  width:10px;
}

.modal-body::-webkit-scrollbar-track{
  background:rgba(15,17,19,.06);
  border-radius:999px;
}

.modal-body::-webkit-scrollbar-thumb{
  background:rgba(43,47,51,.3);
  border-radius:999px;
}

.modal-gallery{
  display:flex;
  gap:18px;
  overflow-x:auto;
  padding-bottom:8px;
  scroll-snap-type:x mandatory;
}

.modal-gallery figure{
  margin:0;
  min-width:min(320px, 70vw);
  scroll-snap-align:start;
  border-radius:var(--radius-lg);
  overflow:hidden;
  border:1px solid rgba(15,17,19,.12);
  background:var(--taupe);
  box-shadow:var(--shadow-1);
}

.modal-gallery img{
  display:block;
  width:100%;
  height:auto;
}

.modal-note{
  padding:18px 20px;
  border-radius:var(--radius-lg);
  background:rgba(228,221,204,.45);
  border:1px solid rgba(15,17,19,.12);
  font-size:.95rem;
  color:var(--slate);
}

.modal-note strong{display:block;margin-bottom:6px;}

.modal-viewer{
  width:100%;
  height:420px;
  border-radius:var(--radius-lg);
  overflow:hidden;
  border:1px solid rgba(15,17,19,.14);
  box-shadow:var(--shadow-1);
  background:var(--taupe);
}

.modal-viewer model-viewer{
  width:100%;
  height:100%;
  --poster-color:rgba(43,47,51,.9);
}

.modal-viewer .viewer-placeholder{
  width:100%;
  height:100%;
  display:grid;
  place-items:center;
  padding:32px;
  text-align:center;
  color:var(--muted);
  font-weight:600;
  background:rgba(43,47,51,.05);
}

.modal-viewer .viewer-placeholder strong{
  display:block;
  margin-bottom:8px;
  color:var(--slate-strong);
}

.modal-collection-nav{
  position:sticky;
  top:0;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  padding:6px 4px 12px;
  margin:0 0 12px;
  background:linear-gradient(180deg, rgba(255,255,255,.94) 0%, rgba(255,255,255,.74) 80%, rgba(255,255,255,0) 100%);
  backdrop-filter:blur(8px);
  z-index:1;
}

.modal-viewer .viewer-placeholder p{
  margin:6px 0 0;
  line-height:1.45;
}

.modal-viewer .viewer-placeholder__refs{
  margin:12px 0 0;
  padding:0;
  list-style:none;
  width:100%;
}

.modal-viewer .viewer-placeholder__refs li{
  margin:4px 0;
  font-size:.9rem;
  color:var(--muted);
}

.modal-viewer .viewer-placeholder__refs code{
  font-family:'Fira Code','SFMono-Regular','Menlo','Consolas',monospace;
  font-size:.85rem;
  color:var(--slate-strong);
  background:rgba(15,17,19,.08);
  padding:2px 6px;
  border-radius:4px;
}

.modal-viewer .viewer-placeholder__ref-type{
  font-size:.82rem;
  color:var(--slate);
}

.modal-viewer .viewer-placeholder__ref-status{
  font-weight:600;
}

.modal-viewer .viewer-placeholder__ref-status[data-status='found']{
  color:var(--slate-strong);
}

.modal-viewer .viewer-placeholder__ref-status[data-status='missing']{
  color:#b1402f;
}

.modal-viewer .viewer-placeholder__ref-status[data-status='unknown'],
.modal-viewer .viewer-placeholder__ref-status[data-status='invalid']{
  color:var(--muted);
}

.modal-collection-chip{
  border-radius:999px;
  border:1px solid rgba(15,17,19,.12);
  background:#fff;
  padding:8px 16px;
  font-size:.9rem;
  font-weight:600;
  color:var(--muted);
  cursor:pointer;
  transition:color .2s ease, border-color .2s ease, box-shadow .2s ease;
}

.modal-collection-chip:hover,
.modal-collection-chip:focus-visible{
  color:var(--slate-strong);
  border-color:rgba(15,17,19,.24);
  box-shadow:0 6px 12px rgba(15,17,19,.12);
}

.modal-collection-chip.is-active{
  color:var(--slate-strong);
  border-color:rgba(228,221,204,.9);
  background:rgba(228,221,204,.55);
  box-shadow:0 10px 24px rgba(15,17,19,.18);
}

.modal-collection{
  display:flex;
  flex-direction:column;
  gap:36px;
  padding-bottom:8px;
}

.modal-project{
  padding:24px 24px 28px;
  border-radius:var(--radius-xl);
  border:1px solid rgba(15,17,19,.08);
  box-shadow:var(--shadow-1);
  background:#fff;
  display:flex;
  flex-direction:column;
  gap:22px;
  scroll-margin-top:92px;
}

.modal-project.is-active{
  border-color:rgba(228,221,204,.85);
  box-shadow:0 24px 44px rgba(15,17,19,.2);
}

.modal-project-head h3{
  margin:0;
  font-size:clamp(1.3rem, 3vw, 1.9rem);
  color:var(--slate-strong);
}

.modal-project-summary{
  margin:8px 0 0;
  color:var(--muted);
  font-size:1rem;
  line-height:1.55;
}

.modal-project .modal-gallery,
.modal-project .modal-viewer,
.modal-project .modal-note{
  margin:0;
}

.modal-project .modal-note{
  box-shadow:none;
}

@media (max-width:720px){
  .modal-body{
    max-height:none;
    padding-right:0;
  }

  .modal-collection-nav{
    position:static;
    background:none;
    padding:0 0 12px;
  }

  .modal-project{
    padding:20px 18px 24px;
    gap:18px;
  }
}

body.modal-open{overflow:hidden;}
